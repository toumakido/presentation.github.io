<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åå‰ä»˜ããƒ­ãƒƒã‚¯ã§å®Ÿç¾ã™ã‚‹æ’ä»–åˆ¶å¾¡</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Hiragino Sans', 'Yu Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
        }

        .slide-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            display: none;
            width: 98%;
            /* max-width: 1200px; */
            height: 98vh;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.5s ease-out;
            overflow: hidden;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            font-size: 3.0em;
            color: #2d3748;
            margin-bottom: 15px;
            text-align: center;
        }

        h2 {
            font-size: 2.7em;
            color: #2d3748;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        h3 {
            font-size: 2.5em;
            color: #4a5568;
            margin: 15px 0 10px 0;
        }

        .subtitle {
            font-size: 2.7em;
            color: #718096;
            text-align: center;
            margin-bottom: 30px;
        }

        .content {
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        ul {
            font-size: 2.1em;
            line-height: 1.6;
            color: #4a5568;
            margin-left: 30px;
        }

        li {
            margin: 8px 0;
        }

        code {
            background: #f7fafc;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            color: #e53e3e;
            font-size: 1.9em;
        }

        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 1.9em;
            line-height: 1.4;
            margin: 10px 0;
            font-family: 'Consolas', 'Monaco', monospace;
        }

        .highlight {
            background: #fef5e7;
            padding: 12px;
            border-left: 4px solid #f39c12;
            margin: 10px 0;
            border-radius: 5px;
        }

        .problem {
            background: #fee;
            padding: 12px;
            border-left: 4px solid #e53e3e;
            margin: 10px 0;
            border-radius: 5px;
        }

        .solution {
            background: #e6ffed;
            padding: 12px;
            border-left: 4px solid #38a169;
            margin: 10px 0;
            border-radius: 5px;
        }

        .navigation {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            gap: 15px;
        }

        button {
            padding: 15px 30px;
            font-size: 1.2em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            background: #667eea;
            color: white;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            box-shadow: none;
        }

        .slide-number {
            display: none;
            position: fixed;
            bottom: 30px;
            left: 30px;
            font-size: 1.3em;
            color: white;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px 20px;
            border-radius: 10px;
        }

        .diagram {
            background: #f7fafc;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 0.95em;
            line-height: 1.5;
        }

        .arrow {
            color: #e53e3e;
            font-weight: bold;
        }

        strong {
            color: #2d3748;
            font-weight: 600;
        }

        .code-small {
            font-size: 1.75em;
            line-height: 1.3;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 15px 0;
        }

        .column-item {
            padding: 15px;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="slide-container">
        <!-- Slide 1: ã‚¿ã‚¤ãƒˆãƒ« -->
        <div class="slide active">
            <div class="content" style="position: relative;">
                <div style="text-align: center; margin-top: 80px;">
                    <h1 style="font-size: 3.5em; margin-bottom: 30px;">åå‰ä»˜ããƒ­ãƒƒã‚¯ã§å®Ÿç¾ã™ã‚‹æ’ä»–åˆ¶å¾¡</h1>
                    <p style="font-size: 2.0em; color: #4a5568;">Mysqlã®åå‰ä»˜ããƒ­ãƒƒã‚¯ã«ã¤ã„ã¦ã¨Goã§ã®å®Ÿè£…</p>
                </div>
                <div style="position: absolute; bottom: 60px; left: 50%; transform: translateX(-50%); display: flex; flex-direction: column; align-items: center; gap: 15px;">
                    <img src="logo.png" alt="Company Logo" style="height: 80px; width: auto;">
                    <p style="font-size: 1.6em; color: #4a5568; margin: 0;">toumakido</p>
                </div>
            </div>
        </div>

         <!-- Slide 2: è‡ªå·±ç´¹ä»‹ -->
        <div class="slide">
            <div class="content">
                <h2 >è‡ªå·±ç´¹ä»‹</h2>
                <div style="display: flex; align-items: center; justify-content: center; gap: 40px; flex: 1;">
                    <div style="display: flex; align-items: center; gap: 40px; max-width: 1000px;">
                        <div style="flex: 0 0 auto;">
                            <img src="profile.jpg" alt="ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å†™çœŸ" style="max-width: 400px; max-height: 500px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                        </div>
                        <div class="profile-info" style="flex: 1; font-size: 2.0em;">
                            <p><span class="emoji">ğŸ¢</span><strong>æ‰€å±ï¼š</strong>Finatext è¨¼åˆ¸äº‹æ¥­</p>
                            <p><span class="emoji">ğŸ’»</span><strong>è·ç¨®ï¼š</strong>ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢</p>
                            <p><span class="emoji">ğŸ“</span><strong>å…¥ç¤¾ï¼š</strong>25å’</p>
                            <p><span class="emoji">ğŸ‘¤</span><strong>åå‰ï¼š</strong>åŸæˆ¸é€é¦¬</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 2: å•é¡Œæèµ· -->
        <div class="slide">
            <div class="content">
                <h2>å•é¡Œï¼šSELECT FOR UPDATEã®é™ç•Œ</h2>
                <h3>åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã§ã®å®Ÿè£…</h3>
                <pre>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹

å•†å“ã®åœ¨åº«ã‚’ãƒ­ãƒƒã‚¯ã—ã¦å–å¾— (SELECT FOR UPDATE)
if (åœ¨åº«ãŒå­˜åœ¨ã™ã‚‹) {
    åœ¨åº«ã‚’å¢—ã‚„ã™ (UPDATE)
} else {
    æ–°ã—ã„åœ¨åº«ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ (INSERT)
}

ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³çµ‚äº†</pre>
                <div class="problem">
                    <h3 style="font-size: 1.9em;">âŒ ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨ã—ãªã„å ´åˆã€ãƒ­ãƒƒã‚¯ã§ããªã„</h3>
                    <!-- <ul>
                        <li><code>SELECT FOR UPDATE</code>ã¯<strong>å­˜åœ¨ã™ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰</strong>ã«ã—ã‹ãƒ­ãƒƒã‚¯ã‚’ã‹ã‘ã‚‰ã‚Œãªã„</li>
                    </ul> -->
                </div>
            </div>
        </div>

        <!-- Slide 3: ä¸€èˆ¬çš„ãªè§£æ±ºç­– -->
        <div class="slide">
            <div class="content">
                <h2>ä¸€èˆ¬çš„ãªè§£æ±ºç­–ã¨ãã®èª²é¡Œ</h2>
                <div class="two-column">
                    <div class="column-item" style="background: #f7fafc; border: 2px solid #4a5568;">
                        <h3 style="margin-top: 0;">è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ­ãƒƒã‚¯</h3>
                        <div class="problem" style="margin-top: 10px;">
                            <strong style="font-size: 1.95em;">èª²é¡Œï¼š</strong>
                            <ul style="font-size: 1.95em; margin-left: 20px;">
                                <li>é©åˆ‡ãªè¦ªãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆãŒã‚ã‚‹</li>
                                <li>é–¢ä¿‚ã®ãªã„å‡¦ç†ã¾ã§å¾…æ©Ÿã•ã›ã¦ã—ã¾ã†</li>
                            </ul>
                        </div>
                    </div>
                    <div class="column-item" style="background: #f7fafc; border: 2px solid #4a5568;">
                        <h3 style="margin-top: 0;">åˆæœŸå€¤ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä½œæˆ</h3>
                        <div class="problem" style="margin-top: 10px;">
                            <strong style="font-size: 1.95em;">èª²é¡Œï¼š</strong>
                            <ul style="font-size: 1.95em; margin-left: 20px;">
                                <li>ãƒ€ãƒŸãƒ¼ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ç®¡ç†ãŒå¿…è¦</li>
                                <li>åˆæœŸå€¤ã‚’ç”¨æ„ã§ããªã„å ´åˆãŒã‚ã‚‹</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="highlight" style="margin-top: 15px; text-align: center;">
                    <strong style="font-size: 2.2em;">â†’ ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å­˜åœ¨ã«ä¾å­˜ã—ãªã„æ’ä»–åˆ¶å¾¡ãŒå¿…è¦ï¼</strong>
                </div>
            </div>
        </div>

        <!-- Slide 4: åå‰ä»˜ããƒ­ãƒƒã‚¯ã¨ã¯ -->
        <div class="slide">
            <div class="content">
                <h2>åå‰ä»˜ããƒ­ãƒƒã‚¯ã«ã‚ˆã‚‹è§£æ±º</h2>
                <h3>MySQLã®åå‰ä»˜ããƒ­ãƒƒã‚¯ï¼ˆNamed Lockï¼‰</h3>
                <ul>
                    <li>ä»»æ„ã®æ–‡å­—åˆ—ã‚’ã‚­ãƒ¼ã¨ã—ã¦ãƒ­ãƒƒã‚¯ã‚’å–å¾—ãƒ»è§£æ”¾</li>
                    <li><strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ä¾å­˜ã—ãªã„</strong></li>
                </ul>
                <div class="two-column">
                    <div class="column-item" style="background: #2d3748; border-radius: 8px;">
                        <h3 style="margin-top: 0; color: #e2e8f0; font-size: 2.2em;">ãƒ­ãƒƒã‚¯ã®å–å¾—</h3>
                        <pre style="margin: 0; padding: 10px; background: transparent; font-size: 1.6em;">SELECT GET_LOCK('product_ABC123', 10);

-- æˆ»ã‚Šå€¤:
-- 1=æˆåŠŸ
-- 0=ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
-- NULL=ã‚¨ãƒ©ãƒ¼</pre>
                    </div>
                    <div class="column-item" style="background: #2d3748; border-radius: 8px;">
                        <h3 style="margin-top: 0; color: #e2e8f0; font-size: 2.2em;">ãƒ­ãƒƒã‚¯ã®è§£æ”¾</h3>
                        <pre style="margin: 0; padding: 10px; background: transparent; font-size: 1.6em;">SELECT RELEASE_LOCK('product_ABC123');

-- æˆ»ã‚Šå€¤:
-- 1=æˆåŠŸ
-- 0=ãƒ­ãƒƒã‚¯å­˜åœ¨ã›ãš
-- NULL=ã‚¨ãƒ©ãƒ¼</pre>
                    </div>
                </div>
                <div class="solution">
                    <strong style="font-size: 2.2em;">âœ… ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å­˜åœ¨ã«é–¢ä¿‚ãªãç¢ºå®Ÿã«ãƒ­ãƒƒã‚¯ãŒå–å¾—ã§ãã‚‹ï¼</strong><br>
                </div>
            </div>
        </div>

        <!-- Slide 5: æ™®é€šã«å®Ÿè£…ã™ã‚‹ã¨ï¼ˆã‚±ãƒ¼ã‚¹1ï¼‰ -->
        <div class="slide">
            <div class="content">
                <h2>Goã§æ™®é€šã«å®Ÿè£…ã™ã‚‹ã¨...ï¼ˆã‚±ãƒ¼ã‚¹1ï¼‰</h2>
                <pre class="code-small">
// ãƒ­ãƒƒã‚¯å–å¾—
_, err := s.db.Exec("SELECT GET_LOCK(?, 10)", lockName)  <span style="color: #f59e0b;">// ã‚»ãƒƒã‚·ãƒ§ãƒ³A</span>
if err != nil { return err }

// å®Ÿéš›ã®å‡¦ç†ï¼ˆSELECT, INSERT, UPDATE ãªã©ï¼‰
// ...

// ãƒ­ãƒƒã‚¯è§£æ”¾
_, err = s.db.Exec("SELECT RELEASE_LOCK(?)", lockName)  <span style="color: #f59e0b;">// ã‚»ãƒƒã‚·ãƒ§ãƒ³B</span>
return err
</pre>
                <div class="highlight">
                    <h3>åå‰ä»˜ããƒ­ãƒƒã‚¯ã¯ã€ãƒ­ãƒƒã‚¯ã‚’å–å¾—ã—ãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã—ã‹è§£æ”¾ã§ããªã„</h3>
                </div>
                <!-- <div class="problem">
                    <h3>âŒ å®Ÿéš›ã«èµ·ã“ã‚‹å•é¡Œ</h3>
                    <div class="diagram" style="font-size: 1.2em;">
GET_LOCK â†’ ãƒ—ãƒ¼ãƒ«ã‹ã‚‰<strong>ã‚»ãƒƒã‚·ãƒ§ãƒ³A</strong>å–å¾— â†’ ãƒ­ãƒƒã‚¯æˆåŠŸ<br>
RELEASE_LOCK â†’ ãƒ—ãƒ¼ãƒ«ã‹ã‚‰<strong>ã‚»ãƒƒã‚·ãƒ§ãƒ³B</strong>å–å¾— â†’ <span class="arrow">è§£æ”¾å¤±æ•—</span><br>
<span class="arrow">â†’ ã‚»ãƒƒã‚·ãƒ§ãƒ³Aã®ãƒ­ãƒƒã‚¯ãŒæ®‹ã‚Šç¶šã‘ã‚‹</span>
                    </div>
                </div> -->
            </div>
        </div>

        <!-- Slide 6: æ™®é€šã«å®Ÿè£…ã™ã‚‹ã¨ï¼ˆã‚±ãƒ¼ã‚¹2ï¼‰ -->
        <div class="slide">
            <div class="content">
                <h2>Goã§æ™®é€šã«å®Ÿè£…ã™ã‚‹ã¨...ï¼ˆã‚±ãƒ¼ã‚¹2ï¼‰</h2>
                <div class="highlight">
                    <h3>åå‰ä»˜ããƒ­ãƒƒã‚¯ã¯ã€åŒä¸€ã‚»ãƒƒã‚·ãƒ§ãƒ³å†…ã§ã¯åŒã˜ãƒ­ãƒƒã‚¯ã‚’è¤‡æ•°å›å–å¾—ã§ãã‚‹ï¼ˆä»–ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å ´åˆã«å¾…æ©Ÿï¼‰</h3>
                </div>
                <div class="problem">
                    <!-- <h3>âŒ å®Ÿéš›ã«èµ·ã“ã‚‹å•é¡Œ</h3> -->
                    <div class="diagram" style="font-size: 2.5em;">
ãƒªã‚¯ã‚¨ã‚¹ãƒˆ1: GET_LOCK â†’ ãƒ—ãƒ¼ãƒ«ã‹ã‚‰<strong>ã‚»ãƒƒã‚·ãƒ§ãƒ³100</strong>å–å¾— â†’ æˆåŠŸ<br>
ãƒªã‚¯ã‚¨ã‚¹ãƒˆ2: GET_LOCK â†’ ãƒ—ãƒ¼ãƒ«ã‹ã‚‰<strong>ã‚»ãƒƒã‚·ãƒ§ãƒ³100</strong>å†åˆ©ç”¨<br>
<span class="arrow">â†’ åŒä¸€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãªã®ã§æˆåŠŸã—ã¦ã—ã¾ã†</span><br>
<span class="arrow">â†’ æœ¬æ¥å¾…æ©Ÿã™ã¹ããƒªã‚¯ã‚¨ã‚¹ãƒˆ2ãŒé€šã‚‹</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 7: æ­£ã—ã„å®Ÿè£…æ–¹æ³• -->
        <div class="slide">
            <div class="content">
                <h2>ãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«æ’ä»–åˆ¶å¾¡ã‚’ã™ã‚‹å®Ÿè£…</h2>
                <pre class="code-small"><span style="color: #f59e0b;">conn, err := s.db.Conn(ctx) // å°‚ç”¨ã‚»ãƒƒã‚·ãƒ§ãƒ³(database/sql.Conn)ã‚’ç™ºè¡Œ</span>
if err != nil {
    return err
}

err = <span style="color: #f59e0b;">conn.GetLock</span>(ctx, lockName) // å°‚ç”¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ãƒ­ãƒƒã‚¯å–å¾—
if err != nil {
    return err
}

// ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†
tx, err := s.db.BeginTx(ctx)
... å®Ÿéš›ã®å‡¦ç† ...

<span style="color: #f59e0b;">conn.ReleaseLock</span>(ctx, lockName) // å°‚ç”¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ãƒ­ãƒƒã‚¯ãƒªãƒªãƒ¼ã‚¹
conn.Close()
</pre>
                <!-- <div class="solution">
                    <strong>âœ… åŒä¸€ã‚»ãƒƒã‚·ãƒ§ãƒ³å†…ã§ãƒ­ãƒƒã‚¯å–å¾—ãƒ»è§£æ”¾ã‚’å®Ÿè¡Œ</strong><br>
                    <strong>âœ… å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒç‹¬è‡ªã®å°‚ç”¨ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚’å–å¾—</strong>
                </div> -->
            </div>
        </div>

        <!-- Slide 8: ã¾ã¨ã‚ -->
        <div class="slide">
            <div class="content">
                <h2>ã¾ã¨ã‚</h2>
                <div class="highlight">
                    <h3>âœ… åå‰ä»˜ããƒ­ãƒƒã‚¯ã®åˆ©ç‚¹</h3>
                    <ul>
                        <li>ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å­˜åœ¨ã«é–¢ä¿‚ãªãç¢ºå®Ÿã«ãƒ­ãƒƒã‚¯ãŒå–å¾—ã§ãã‚‹</li>
                        <li>å°‚ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚„ãƒ€ãƒŸãƒ¼ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒä¸è¦</li>
                        <li>ãƒ­ãƒƒã‚¯åã‚’è‡ªç”±ã«è¨­è¨ˆã§ãã‚‹</li>
                    </ul>
                </div>
                <div class="problem">
                    <h3>âš ï¸ Goã§ã®å®Ÿè£…ã®æ³¨æ„ç‚¹</h3>
                    <ul>
                        <li><strong>å°‚ç”¨ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ï¼ˆconnï¼‰ã®ç¢ºä¿ãŒå¿…è¦</strong></li>
                        <li>åŒä¸€ã‚»ãƒƒã‚·ãƒ§ãƒ³å†…ã§ãƒ­ãƒƒã‚¯å–å¾—ãƒ»è§£æ”¾ã‚’å®Ÿè¡Œ</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="slide-number">
        <span id="current-slide">1</span> / <span id="total-slides">8</span>
    </div>

    <!-- <div class="navigation">
        <button id="prev-btn" onclick="previousSlide()">â† å‰ã¸</button>
        <button id="next-btn" onclick="nextSlide()">æ¬¡ã¸ â†’</button>
    </div> -->

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        document.getElementById('total-slides').textContent = totalSlides;

        function showSlide(n) {
            slides[currentSlide].classList.remove('active');
            currentSlide = (n + totalSlides) % totalSlides;
            slides[currentSlide].classList.add('active');
            
            document.getElementById('current-slide').textContent = currentSlide + 1;
            
            document.getElementById('prev-btn').disabled = currentSlide === 0;
            document.getElementById('next-btn').disabled = currentSlide === totalSlides - 1;
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                showSlide(currentSlide + 1);
            }
        }

        function previousSlide() {
            if (currentSlide > 0) {
                showSlide(currentSlide - 1);
            }
        }

        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                nextSlide();
            } else if (e.key === 'ArrowLeft') {
                previousSlide();
            }
        });

        // åˆæœŸçŠ¶æ…‹
        showSlide(0);
    </script>
</body>
</html>
