<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWSのPQC対応について</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/theme/black.css">
    <style>
        .reveal .slides { text-align: left; }
        .reveal h1 { font-size: 2em; margin-bottom: 0.5em; }
        .reveal h2 { font-size: 1.5em; margin-bottom: 0.4em; }
        .reveal h3 { font-size: 1.2em; margin-bottom: 0.3em; margin-top: 0.5em; }
        .reveal h4 { font-size: 1em; margin-bottom: 0.3em; margin-top: 0.5em; }
        .reveal p { margin: 0.5em 0; font-size: 0.8em; }
        .reveal ul { font-size: 0.75em; margin-left: 1.5em; }
        .reveal ol { font-size: 0.75em; margin-left: 1.5em; }
        .reveal li { margin: 0.3em 0; }
        .reveal code { background: #3f3f3f; padding: 0.2em 0.5em; border-radius: 3px; font-size: 0.9em; }
        .reveal pre { font-size: 0.6em; margin: 0.5em 0; }
        .reveal pre code { padding: 1em; }
        .reveal blockquote { font-size: 0.7em; margin: 0.5em 0; padding: 0.5em; border-left: 3px solid #42affa; }
        .reveal section { height: 100%; display: flex; flex-direction: column; justify-content: flex-start; padding: 20px 40px; }
        .diagram { margin: 1em 0; }
        .small-text { font-size: 0.7em; }
        .highlight { color: #42affa; }
        .warning { color: #ff6b6b; }
        .success { color: #51cf66; }
        .two-column { display: flex; gap: 1.5em; margin: 1em 0; }
        .two-column > div { flex: 1; }
        .title-slide { text-align: center; justify-content: center !important; }
        .end-slide { text-align: center; justify-content: center !important; }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">
            <!-- タイトル -->
            <section class="title-slide">
                <h1>AWSのPQC対応について</h1>
                <p>Post-Quantum Cryptography（耐量子計算機暗号）</p>
            </section>

            <!-- PQCとは -->
            <section>
                <h2>PQCとは</h2>
                <h3>Post-Quantum Cryptography<br>（耐量子計算機暗号）</h3>
                <p>量子コンピュータによる解読を防ぐ次世代の暗号技術</p>
                <ul>
                    <li>量子コンピュータでも解読が困難な数学的問題に基づく</li>
                    <li>NIST（米国標準技術研究所）が2024年に標準化</li>
                    <li>主なアルゴリズム: ML-KEM（旧Kyber）、ML-DSA（旧Dilithium）など</li>
                </ul>
            </section>

            <!-- なぜ今対応が必要なのか -->
            <section>
                <h2>なぜ今対応が必要なのか</h2>
                <h3 class="warning">"Harvest Now, Decrypt Later" 攻撃</h3>
                <svg class="diagram" width="800" height="340" viewBox="0 0 700 300">
                    <!-- 現在 -->
                    <text x="50" y="40" fill="#42affa" font-size="24" font-weight="bold">現在</text>
                    <rect x="30" y="60" width="200" height="80" fill="#3f3f3f" stroke="#42affa" stroke-width="2" rx="5"/>
                    <text x="130" y="95" fill="white" font-size="18" text-anchor="middle">暗号化通信</text>
                    <text x="130" y="120" fill="white" font-size="16" text-anchor="middle">↓ 記録・保存</text>

                    <!-- 矢印 -->
                    <line x1="250" y1="100" x2="320" y2="100" stroke="#ff6b6b" stroke-width="3" marker-end="url(#arrowhead)"/>
                    <text x="285" y="85" fill="#ff6b6b" font-size="16" text-anchor="middle">時間経過</text>

                    <!-- 将来 -->
                    <text x="470" y="40" fill="#ff6b6b" font-size="24" font-weight="bold">将来</text>
                    <rect x="350" y="60" width="200" height="80" fill="#3f3f3f" stroke="#ff6b6b" stroke-width="2" rx="5"/>
                    <text x="450" y="95" fill="white" font-size="18" text-anchor="middle">量子コンピュータ</text>
                    <text x="450" y="120" fill="white" font-size="16" text-anchor="middle">↓ 解読</text>

                    <!-- 問題点 -->
                    <text x="50" y="180" fill="white" font-size="18" font-weight="bold">問題点:</text>
                    <text x="50" y="210" fill="white" font-size="16">• 現在の暗号（RSA、ECDHE等）は量子コンピュータで解読可能に</text>
                    <text x="50" y="235" fill="white" font-size="16">• 機密性の高いデータは長期間保護が必要</text>
                    <text x="50" y="260" fill="white" font-size="16">• 量子コンピュータの実用化を待ってからでは遅い</text>

                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#ff6b6b"/>
                        </marker>
                    </defs>
                </svg>
            </section>

            <!-- TLSについて -->
            <section>
                <h2>TLSの暗号スイートの構成要素</h2>
                <p class="small-text">例：<code>ECDHE-RSA-AES128-GCM-SHA256</code></p>
                <ul class="small-text">
                    <li><strong class="highlight">鍵交換 (ECDHE)</strong>: クライアントとサーバーが暗号鍵を安全に共有
                        <ul><li>楕円曲線ディフィー・ヘルマン鍵交換、第三者に傍受されても鍵が漏れない</li></ul>
                    </li>
                    <li><strong class="highlight">認証 (RSA)</strong>: 通信相手（サーバー）が本物かを確認
                        <ul><li>デジタル証明書による認証、中間者攻撃を防ぐ</li></ul>
                    </li>
                    <li><strong class="highlight">共通鍵暗号 (AES128-GCM)</strong>: 実際のデータの暗号化
                        <ul><li>128ビット鍵のAES、GCMモードで認証付き暗号化</li></ul>
                    </li>
                    <li><strong class="highlight">ハッシュ (SHA256)</strong>: データの改ざん検知とメッセージ認証
                        <ul><li>256ビットのハッシュ値を生成、データの完全性を保証</li></ul>
                    </li>
                </ul>
            </section>

            <!-- TLSハンドシェーク -->
            <section>
                <h2>暗号スイートの決定プロセス</h2>
                <h3>TLSハンドシェーク</h3>
                <svg class="diagram" width="800" height="480" viewBox="0 0 650 400">
                    <!-- クライアント -->
                    <rect x="30" y="30" width="120" height="60" fill="#3f3f3f" stroke="#42affa" stroke-width="3" rx="5"/>
                    <text x="90" y="65" fill="#42affa" font-size="18" text-anchor="middle" font-weight="bold">クライアント</text>

                    <!-- サーバー -->
                    <rect x="480" y="30" width="120" height="60" fill="#3f3f3f" stroke="#51cf66" stroke-width="3" rx="5"/>
                    <text x="540" y="65" fill="#51cf66" font-size="18" text-anchor="middle" font-weight="bold">サーバー</text>

                    <!-- Client Hello -->
                    <line x1="90" y1="100" x2="540" y2="130" stroke="#42affa" stroke-width="3" marker-end="url(#arrow-hello1)"/>
                    <text x="315" y="110" fill="#42affa" font-size="16" text-anchor="middle" font-weight="bold">1. Client Hello</text>

                    <rect x="180" y="140" width="280" height="70" fill="#2a2a2a" stroke="#42affa" stroke-width="2" rx="5"/>
                    <text x="320" y="160" fill="white" font-size="14" text-anchor="middle">対応する暗号スイートのリスト</text>
                    <text x="200" y="180" fill="#42affa" font-size="13">• ECDHE-RSA-AES256-GCM-SHA384</text>
                    <text x="200" y="197" fill="#42affa" font-size="13">• ECDHE-RSA-AES128-GCM-SHA256</text>

                    <!-- Server Hello -->
                    <line x1="540" y1="220" x2="90" y2="250" stroke="#51cf66" stroke-width="3" marker-end="url(#arrow-hello2)"/>
                    <text x="315" y="230" fill="#51cf66" font-size="16" text-anchor="middle" font-weight="bold">2. Server Hello</text>

                    <rect x="180" y="260" width="280" height="50" fill="#2a2a2a" stroke="#51cf66" stroke-width="2" rx="5"/>
                    <text x="320" y="280" fill="white" font-size="14" text-anchor="middle">選択された暗号スイート</text>
                    <text x="320" y="300" fill="#51cf66" font-size="13" text-anchor="middle" font-weight="bold">ECDHE-RSA-AES256-GCM-SHA384</text>

                    <!-- 選択基準 -->
                    <rect x="30" y="330" width="590" height="60" fill="#2a2a2a" stroke="#ff6b6b" stroke-width="2" rx="5"/>
                    <text x="325" y="350" fill="#ff6b6b" font-size="15" text-anchor="middle" font-weight="bold">3. 選択基準</text>
                    <text x="40" y="370" fill="white" font-size="13">• 両者が対応する暗号スイートの中で最も強力なものを優先</text>
                    <text x="40" y="385" fill="white" font-size="13">• サーバー側のポリシーで優先順位を設定可能</text>

                    <defs>
                        <marker id="arrow-hello1" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#42affa"/>
                        </marker>
                        <marker id="arrow-hello2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#51cf66"/>
                        </marker>
                    </defs>
                </svg>
            </section>

            <!-- PQCの適用箇所 -->
            <section>
                <h2>PQCの適用箇所</h2>
                <h3>現段階では、鍵交換にPQCを適用していく</h3>
                <h3>AWSのPQC移行ワークストリーム</h3>
                <ol class="small-text">
                    <li><strong>棚卸しと計画（継続的）</strong>: 暗号使用箇所の把握</li>
                    <li><strong class="success">転送中のデータ保護（最優先・展開中）</strong>: HNDL脅威に直接対抗するため</li>
                    <li><strong>デジタル署名（優先度高・実装段階）</strong>: 長期的な真正性担保（ML-DSA等）</li>
                    <li><strong>セッション認証（中優先度・将来）</strong>: 短期的な認証</li>
                </ol>
            </section>

            <!-- AWSのPQC対応方針 -->
            <section>
                <h2>AWSのPQC対応方針</h2>
                <h3>ハイブリッド暗号方式の採用</h3>
                <p class="small-text">従来のアルゴリズム（ECDHE）とPQCアルゴリズムを<strong class="highlight">併用</strong> → どちらか一方が破られても安全性を維持</p>
                <svg class="diagram" width="650" height="85" viewBox="0 0 540 70">
                    <rect x="10" y="5" width="120" height="55" fill="#3f3f3f" stroke="#42affa" stroke-width="2" rx="5"/>
                    <text x="70" y="37" fill="#42affa" font-size="14" text-anchor="middle" font-weight="bold">ECDHE鍵</text>

                    <text x="150" y="37" fill="white" font-size="24" text-anchor="middle">+</text>

                    <rect x="170" y="5" width="120" height="55" fill="#3f3f3f" stroke="#51cf66" stroke-width="2" rx="5"/>
                    <text x="230" y="32" fill="#51cf66" font-size="14" text-anchor="middle" font-weight="bold">PQC鍵</text>
                    <text x="230" y="48" fill="#51cf66" font-size="12" text-anchor="middle">(ML-KEM等)</text>

                    <text x="310" y="37" fill="white" font-size="20" text-anchor="middle">=</text>

                    <rect x="330" y="5" width="100" height="55" fill="#3f3f3f" stroke="#ff6b6b" stroke-width="2" rx="5"/>
                    <text x="380" y="30" fill="#ff6b6b" font-size="13" text-anchor="middle" font-weight="bold">最終的な共有鍵</text>
                </svg>

                <h3>責任共有モデル</h3>
                <p class="small-text">クラウドの基盤部分（インフラ）のPQC対応はAWSが行い、アプリケーションやデータのPQC対応は顧客が行う</p>
            </section>

            <!-- 対応する時に考えること -->
            <section>
                <h2>アプリケーションの通信データ保護</h2>
                <p>クライアント → サーバ の通信のPQC対応</p>
                <p class="small-text">今回はサーバとしての通信の対応について</p>
                <svg class="diagram" width="900" height="560" viewBox="0 0 720 500">
                    <!-- VPC境界 -->
                    <rect x="20" y="80" width="680" height="370" fill="none" stroke="#666" stroke-width="2" stroke-dasharray="5,5" rx="5"/>
                    <text x="30" y="70" fill="#666" font-size="14" font-weight="bold">VPC</text>

                    <!-- パブリックサブネット（右側まで広げる） -->
                    <rect x="40" y="100" width="640" height="160" fill="#1a3a4a" stroke="#42affa" stroke-width="2" rx="5"/>
                    <text x="50" y="120" fill="#42affa" font-size="13" font-weight="bold">パブリックサブネット</text>

                    <!-- プライベートサブネット -->
                    <rect x="40" y="280" width="640" height="150" fill="#2a1a3a" stroke="#9f40ff" stroke-width="2" rx="5"/>
                    <text x="50" y="300" fill="#9f40ff" font-size="13" font-weight="bold">プライベートサブネット</text>

                    <!-- ユーザー（インターネット） -->
                    <circle cx="250" cy="20" r="22" fill="#42affa" stroke="#42affa" stroke-width="2"/>
                    <text x="250" y="26" fill="white" font-size="13" text-anchor="middle" font-weight="bold">ユーザー</text>

                    <!-- インターネットゲートウェイ -->
                    <rect x="215" y="50" width="70" height="22" fill="#3f3f3f" stroke="#888" stroke-width="2" rx="3"/>
                    <text x="250" y="65" fill="#888" font-size="11" text-anchor="middle">IGW</text>

                    <!-- インバウンド通信（サーバとしての通信） -->
                    <line x1="250" y1="42" x2="250" y2="135" stroke="#51cf66" stroke-width="3" marker-end="url(#arrow-inbound)"/>
                    <rect x="265" y="80" width="140" height="35" fill="#2a2a2a" stroke="#51cf66" stroke-width="2" rx="3"/>
                    <text x="335" y="97" fill="#51cf66" font-size="13" text-anchor="middle" font-weight="bold">サーバとしての通信</text>
                    <text x="335" y="110" fill="#ff6b6b" font-size="12" text-anchor="middle" font-weight="bold">→ PQC対応</text>

                    <!-- ALB -->
                    <rect x="160" y="135" width="180" height="55" fill="#ff9900" stroke="#ff9900" stroke-width="2" rx="5"/>
                    <text x="250" y="157" fill="white" font-size="15" text-anchor="middle" font-weight="bold">ALB</text>
                    <text x="250" y="173" fill="white" font-size="11" text-anchor="middle">TLS終端</text>

                    <!-- NAT Gateway -->
                    <rect x="480" y="140" width="160" height="40" fill="#3f3f3f" stroke="#888" stroke-width="2" rx="5"/>
                    <text x="560" y="165" fill="#888" font-size="14" text-anchor="middle" font-weight="bold">NAT Gateway</text>

                    <!-- ALB → ECS -->
                    <line x1="250" y1="195" x2="250" y2="310" stroke="#888" stroke-width="3" marker-end="url(#arrow-internal)"/>
                    <text x="270" y="250" fill="#888" font-size="12">HTTP</text>

                    <!-- ECS -->
                    <rect x="160" y="310" width="180" height="50" fill="#ff6600" stroke="#ff6600" stroke-width="2" rx="5"/>
                    <text x="250" y="333" fill="white" font-size="15" text-anchor="middle" font-weight="bold">ECSタスク</text>
                    <text x="250" y="350" fill="white" font-size="11" text-anchor="middle">アプリケーション実行環境</text>

                    <!-- ECS → NAT Gateway -->
                    <line x1="340" y1="335" x2="480" y2="160" stroke="#42affa" stroke-width="3" marker-end="url(#arrow-outbound)"/>

                    <!-- クライアントとしての通信ラベル -->
                    <rect x="365" y="240" width="140" height="35" fill="#2a2a2a" stroke="#42affa" stroke-width="2" rx="3"/>
                    <text x="435" y="257" fill="#42affa" font-size="13" text-anchor="middle" font-weight="bold">クライアントとしての通信</text>

                    <!-- NAT Gateway → 外部 -->
                    <line x1="560" y1="140" x2="560" y2="80" stroke="#42affa" stroke-width="3" marker-end="url(#arrow-outbound)"/>

                    <!-- 外部API -->
                    <rect x="480" y="30" width="160" height="40" fill="#42affa" stroke="#42affa" stroke-width="2" rx="5"/>
                    <text x="560" y="48" fill="white" font-size="14" text-anchor="middle" font-weight="bold">外部API</text>
                    <text x="560" y="64" fill="white" font-size="12" text-anchor="middle">(インターネット)</text>

                    <defs>
                        <marker id="arrow-inbound" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                            <polygon points="0 0, 10 5, 0 10" fill="#51cf66"/>
                        </marker>
                        <marker id="arrow-internal" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                            <polygon points="0 0, 10 5, 0 10" fill="#888"/>
                        </marker>
                        <marker id="arrow-outbound" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                            <polygon points="0 0, 10 5, 0 10" fill="#42affa"/>
                        </marker>
                    </defs>
                </svg>
            </section>

            <!-- CloudFrontの対応 -->
            <section>
                <h2>CloudFrontの対応</h2>
                <h3 class="success">デフォルトで有効</h3>
                <p>CloudFrontは<strong>すでにPQC対応が完了</strong>しており、追加設定は不要</p>
                <p>クライアントが対応していたら、PQCのネゴシエーションが使用される</p>
            </section>

            <!-- ALBの対応 -->
            <section>
                <h2>ALBの対応</h2>
                <h3>PQC対応セキュリティポリシー</h3>
                <p>AWSが提供するPQC対応ポリシーを適用するだけでOK</p>
                <ul class="small-text">
                    <li><code>ELBSecurityPolicy-TLS13-1-2-2021-06</code> (従来のTLS 1.2, 1.3ポリシー)</li>
                    <li><code class="success">ELBSecurityPolicy-TLS13-1-2-PQ-2025-09</code> (TLS 1.2, 1.3 + PQC)</li>
                </ul>
                <p class="small-text"><strong class="success">後方互換性あり:</strong></p>
                <ul class="small-text">
                    <li>既存のポリシーに<strong>PQC対応の暗号スイートが追加されるのみ</strong></li>
                    <li>PQC非対応クライアントは従来通りの暗号スイートを使用</li>
                    <li>基本的に既存の通信に影響なし</li>
                </ul>
            </section>

            <!-- 気を付けること -->
            <section>
                <h2>ALB更新時に気を付けること</h2>
                <h3 class="warning">1. トラフィック少ない時間帯に更新</h3>
                <p class="small-text">AWS公式ドキュメントより:</p>
                <blockquote class="small-text">
                    セキュリティポリシーを更新すると、ロードバランサーが大量のトラフィックを処理している場合に中断が発生する可能性があります。
                </blockquote>

                <h3 class="warning">2. 複数セキュアリスナーをアタッチしている場合</h3>
                <ul class="small-text">
                    <li>同一ALBに複数のHTTPSリスナー（異なるポート）がある場合、リスナー間でセキュリティポリシーに<strong>互換性が求められる</strong></li>
                    <li>従来のTLSポリシーとPQC対応ポリシーは<strong>互換性なし</strong></li>
                </ul>
            </section>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/reveal.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            transition: 'slide',
            backgroundTransition: 'fade',
            slideNumber: true,
            controls: true,
            progress: true,
            center: false,
            width: 1280,
            height: 800,
            margin: 0.04,
        });
    </script>
</body>
</html>
